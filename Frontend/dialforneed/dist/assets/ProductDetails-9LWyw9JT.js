import{r as t,u as Le,a as We,b as ee,j as e,c as z,d as Be,e as Fe,f as He,g as Xe,h as he,t as ze,m as me,A as xe,T as Ue,i as Ke,R as qe,S as ve,k as Ge,l as Ve,n as P,o as Ye,p as Je,q as Ze,s as Qe,v as es,I as ss,C as ts,w as ns,x as rs,y as as,z as is,M as cs,B as ls,D as os,E as fe,F as X,G as V,H as pe,J as ds,K as us}from"./index-CP13wdj2.js";import{T as hs}from"./Table-BVY38tD3.js";function ms(r,n){const c=t.useRef(!0);t.useEffect(()=>{if(c.current){c.current=!1;return}return r()},n)}const Q=2**31-1;function ge(r,n,c){const d=c-Date.now();r.current=d<=Q?setTimeout(n,d):setTimeout(()=>ge(r,n,c),Q)}function xs(){const r=Le(),n=t.useRef();return We(()=>clearTimeout(n.current)),t.useMemo(()=>{const c=()=>clearTimeout(n.current);function d(h,u=0){r()&&(c(),u<=Q?n.current=setTimeout(h,u):ge(n,h,Date.now()+u))}return{set:d,clear:c,handleRef:n}},[])}const Ne=t.forwardRef(({className:r,bsPrefix:n,as:c="div",...d},h)=>(n=ee(n,"carousel-caption"),e.jsx(c,{ref:h,className:z(r,n),...d})));Ne.displayName="CarouselCaption";const we=t.forwardRef(({as:r="div",bsPrefix:n,className:c,...d},h)=>{const u=z(c,ee(n,"carousel-item"));return e.jsx(r,{ref:h,...d,className:u})});we.displayName="CarouselItem";const fs=40;function ps(r){if(!r||!r.style||!r.parentNode||!r.parentNode.style)return!1;const n=getComputedStyle(r);return n.display!=="none"&&n.visibility!=="hidden"&&getComputedStyle(r.parentNode).display!=="none"}const Ce=t.forwardRef(({defaultActiveIndex:r=0,...n},c)=>{const{as:d="div",bsPrefix:h,slide:u=!0,fade:i=!1,controls:U=!0,indicators:x=!0,indicatorLabels:S=[],activeIndex:f,onSelect:p,onSlide:y,onSlid:b,interval:m=5e3,keyboard:E=!0,onKeyDown:T,pause:N="hover",onMouseOver:_,onMouseOut:L,wrap:R=!0,touch:K=!0,onTouchStart:W,onTouchMove:B,onTouchEnd:F,prevIcon:l=e.jsx("span",{"aria-hidden":"true",className:"carousel-control-prev-icon"}),prevLabel:j="Previous",nextIcon:D=e.jsx("span",{"aria-hidden":"true",className:"carousel-control-next-icon"}),nextLabel:M="Next",variant:se,className:ye,children:Y,...be}=Be({defaultActiveIndex:r,...n},{activeIndex:"onSelect"}),w=ee(h,"carousel"),A=Fe(),O=t.useRef(null),[te,ne]=t.useState("next"),[Se,q]=t.useState(!1),[$,re]=t.useState(!1),[o,Re]=t.useState(f||0);t.useEffect(()=>{!$&&f!==o&&(O.current?ne(O.current):ne((f||0)>o?"next":"prev"),u&&re(!0),Re(f||0))},[f,$,o,u]),t.useEffect(()=>{O.current&&(O.current=null)});let I=0,ae;He(Y,(s,a)=>{++I,a===f&&(ae=s.props.interval)});const ie=Xe(ae),v=t.useCallback(s=>{if($)return;let a=o-1;if(a<0){if(!R)return;a=I-1}O.current="prev",p==null||p(a,s)},[$,o,p,R,I]),g=he(s=>{if($)return;let a=o+1;if(a>=I){if(!R)return;a=0}O.current="next",p==null||p(a,s)}),J=t.useRef();t.useImperativeHandle(c,()=>({element:J.current,prev:v,next:g}));const ce=he(()=>{!document.hidden&&ps(J.current)&&(A?v():g())}),k=te==="next"?"start":"end";ms(()=>{u||(y==null||y(o,k),b==null||b(o,k))},[o]);const Ie=`${w}-item-${te}`,ke=`${w}-item-${k}`,Ee=t.useCallback(s=>{ze(s),y==null||y(o,k)},[y,o,k]),Te=t.useCallback(()=>{re(!1),b==null||b(o,k)},[b,o,k]),De=t.useCallback(s=>{if(E&&!/input|textarea/i.test(s.target.tagName))switch(s.key){case"ArrowLeft":s.preventDefault(),A?g(s):v(s);return;case"ArrowRight":s.preventDefault(),A?v(s):g(s);return}T==null||T(s)},[E,T,v,g,A]),Me=t.useCallback(s=>{N==="hover"&&q(!0),_==null||_(s)},[N,_]),Ae=t.useCallback(s=>{q(!1),L==null||L(s)},[L]),le=t.useRef(0),G=t.useRef(0),oe=xs(),Oe=t.useCallback(s=>{le.current=s.touches[0].clientX,G.current=0,N==="hover"&&q(!0),W==null||W(s)},[N,W]),$e=t.useCallback(s=>{s.touches&&s.touches.length>1?G.current=0:G.current=s.touches[0].clientX-le.current,B==null||B(s)},[B]),Pe=t.useCallback(s=>{if(K){const a=G.current;Math.abs(a)>fs&&(a>0?v(s):g(s))}N==="hover"&&oe.set(()=>{q(!1)},m||void 0),F==null||F(s)},[K,N,v,g,oe,m,F]),de=m!=null&&!Se&&!$,Z=t.useRef();t.useEffect(()=>{var s,a;if(!de)return;const C=A?v:g;return Z.current=window.setInterval(document.visibilityState?ce:C,(s=(a=ie.current)!=null?a:m)!=null?s:void 0),()=>{Z.current!==null&&clearInterval(Z.current)}},[de,v,g,ie,m,ce,A]);const ue=t.useMemo(()=>x&&Array.from({length:I},(s,a)=>C=>{p==null||p(a,C)}),[x,I,p]);return e.jsxs(d,{ref:J,...be,onKeyDown:De,onMouseOver:Me,onMouseOut:Ae,onTouchStart:Oe,onTouchMove:$e,onTouchEnd:Pe,className:z(ye,w,u&&"slide",i&&`${w}-fade`,se&&`${w}-${se}`),children:[x&&e.jsx("div",{className:`${w}-indicators`,children:me(Y,(s,a)=>e.jsx("button",{type:"button","data-bs-target":"","aria-label":S!=null&&S.length?S[a]:`Slide ${a+1}`,className:a===o?"active":void 0,onClick:ue?ue[a]:void 0,"aria-current":a===o},a))}),e.jsx("div",{className:`${w}-inner`,children:me(Y,(s,a)=>{const C=a===o;return u?e.jsx(Ue,{in:C,onEnter:C?Ee:void 0,onEntered:C?Te:void 0,addEndListener:Ke,children:(H,_e)=>t.cloneElement(s,{..._e,className:z(s.props.className,C&&H!=="entered"&&Ie,(H==="entered"||H==="exiting")&&"active",(H==="entering"||H==="exiting")&&ke)})}):t.cloneElement(s,{className:z(s.props.className,C&&"active")})})}),U&&e.jsxs(e.Fragment,{children:[(R||f!==0)&&e.jsxs(xe,{className:`${w}-control-prev`,onClick:v,children:[l,j&&e.jsx("span",{className:"visually-hidden",children:j})]}),(R||f!==I-1)&&e.jsxs(xe,{className:`${w}-control-next`,onClick:g,children:[D,M&&e.jsx("span",{className:"visually-hidden",children:M})]})]})]})});Ce.displayName="Carousel";const je=Object.assign(Ce,{Caption:Ne,Item:we}),js=({reviews:r})=>(console.log(r),e.jsx("div",{children:e.jsxs("div",{class:"container container-fluid",children:[e.jsx("h4",{className:"mt-5",children:"Other's Reviews:"}),e.jsxs("div",{class:"reviews w-100",children:[e.jsx("hr",{}),r&&r.map(n=>{var c,d,h;return e.jsxs("div",{children:[e.jsxs("div",{className:"review-container",children:[e.jsxs("div",{className:"review-user-info",children:[e.jsx("img",{src:(c=n.user)==null?void 0:c.avatar,width:"40",height:"40",className:"review-avatar",alt:""}),e.jsxs("div",{className:"review-user-details d-flex",children:[e.jsx("p",{className:"review-user-name",children:(d=n.user)==null?void 0:d.name})," ",e.jsxs("p",{className:"review-user-email",children:["(",(h=n.user)==null?void 0:h.email,")"]})]})]}),e.jsx(ve,{rating:n.rating}),e.jsx("p",{className:"review-comment",children:n==null?void 0:n.comment})]}),e.jsx("hr",{className:"review-divider"})]},n._id)})]})]})})),vs=qe.memo(js),ws=()=>{const{enqueueSnackbar:r}=Ge(),[n,c]=t.useState(!1),d=()=>c(!0),h=()=>c(!1),{id:u}=Ve(),i=P(Ye),U=P(Je),x=P(Ze),S=P(Qe),[f,p]=t.useState(1),[y,b]=t.useState(""),m=es(),E=P(ss);t.useEffect(()=>{if(E){h(),r("Review Submitted Successfully!",{variant:"success",anchorOrigin:{vertical:"top",horizontal:"center"},onExited:()=>{m(ts())}});return}if(x){r(x,{variant:"error",anchorOrigin:{vertical:"top",horizontal:"center"},onExited:()=>{m(ns())}});return}(!i||E)&&m(rs(u))},[m,u,E,x]),t.useEffect(()=>{if(x){r(x,{variant:"error",anchorOrigin:{vertical:"top",horizontal:"center"}});return}return()=>{m(as())}},[x]);const[T,N]=t.useState(1),_=()=>{N(l=>i.stock===0||l>=i.stock?l:l+1)},L=()=>{N(l=>l===1?l:l-1)},R=l=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(l),K=()=>{m(ds({productId:i._id,quantity:T})),r("Cart Item Added!",{variant:"success",anchorOrigin:{vertical:"top",horizontal:"center"}})},W=()=>{const l=new FormData;l.append("rating",f),l.append("comment",y),l.append("productId",u),m(us(l)),b(""),p("")},B=P(is),F=l=>e.jsx(e.Fragment,{children:i&&e.jsxs(os,{className:"justify-content-between pt-3 ",children:[e.jsx(fe,{xs:12,lg:5,className:"text-center d-flex align-items-start justify-content-center",children:e.jsx(je,{pause:"hover",children:i.images.map((j,D)=>e.jsx(je.Item,{children:e.jsx("img",{src:j.image,alt:`image-${D}`,className:"d-block w-100",style:{width:"100%",height:window.innerWidth<990?"200px":"400px"}})},D))})}),e.jsxs(fe,{xs:12,lg:7,className:`pt-5  mt-lg-0 ${window.innerWidth<990?"px-4":""}`,children:[e.jsx("h3",{children:i.name}),i.reviews.length>0&&e.jsxs("div",{className:"d-flex align-items-center",children:[" ",e.jsx(ve,{rating:i.ratings}),e.jsxs("span",{id:"no_of_reviews",className:"ml-2",children:["(",i.reviews.length," Ratings)"]})]}),e.jsx("hr",{}),e.jsx("p",{id:"product_price",className:"font-weight-bold",children:R(i.price)}),e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx(X,{onClick:L,variant:"danger",className:"mr-2 count",children:"-"}),e.jsx("span",{className:"border p-2 px-3 rounded-2 mx-1",children:T}),e.jsx(X,{onClick:_,variant:"primary",className:"ml-2 count",children:"+"})]}),"   ",e.jsx(X,{type:"button",style:{background:"#1BA786"},onClick:K,disabled:i.stock==0||(S==null?void 0:S.role)==="admin",children:"Add to Cart"})]}),e.jsx("hr",{}),e.jsx(hs,{responsive:!0,borderless:!0,children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{style:{width:"150px"},children:e.jsx("span",{style:{fontWeight:"700"},children:"Status:"})}),e.jsx("td",{children:e.jsx("p",{className:"m-0",children:i.stock>0?e.jsx("span",{id:"stock_status",className:"text-success",children:"In Stock "}):e.jsx("span",{id:"stock_status",className:"text-danger",children:"Out of Stock "})})})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{width:"150px"},children:e.jsx("span",{style:{fontWeight:"700"},children:"Product Type:"})}),e.jsx("td",{children:i.type})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{width:"150px"},children:e.jsx("span",{style:{fontWeight:"700"},children:"Brand:"})}),e.jsx("td",{children:i.brand})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{width:"150px"},children:e.jsx("span",{style:{fontWeight:"700"},children:"Category:"})}),e.jsx("td",{children:i.category})]})]})}),e.jsx("hr",{}),e.jsx("h5",{className:"mt-2",children:"About this Item:"}),e.jsx("p",{children:i.description}),e.jsx("hr",{}),B?e.jsx(X,{id:"review_btn",type:"button",className:"mt-4",onClick:d,children:"Submit Your Review"}):e.jsx("div",{className:"alert alert-danger mt-5",children:"Login to Post Review"}),i.reviews&&i.reviews.length>0?e.jsx(vs,{reviews:i.reviews}):"",e.jsxs(V,{show:n,onHide:h,centered:!0,children:[e.jsx(V.Header,{closeButton:!0,children:e.jsx(V.Title,{children:"Submit Review"})}),e.jsx(V.Body,{className:"",children:e.jsxs("form",{onSubmit:W,children:[e.jsx("ul",{className:"stars list-inline d-flex mt-1 align-items-center justify-content-center",children:[1,2,3,4,5].map((j,D)=>e.jsx("li",{className:`star ${j<=f?"orange":""}`,onClick:()=>p(j),onMouseOver:M=>M.target.classList.add("yellow"),onMouseOut:M=>M.target.classList.remove("yellow"),value:j,children:e.jsx("i",{className:"fa fa-star"})},D))}),e.jsx(pe.Group,{children:e.jsx(pe.Control,{onChange:j=>b(j.target.value),value:y,as:"textarea",rows:3,placeholder:"Write your review"})})," :",e.jsx(X,{diabled:U==="loading",className:"float-right review-btn px-4 text-white",type:"submit",children:"Submit"})]})})]})]})]})});return e.jsxs(t.Fragment,{children:[e.jsx(cs,{title:i?i.name:"Product Details"}),e.jsx("div",{className:"pt-1",children:ls(U,i,x,F)})]})};export{ws as default};
