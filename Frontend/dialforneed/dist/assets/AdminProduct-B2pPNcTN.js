import{k as we,v as De,n as o,P as ke,L as Ee,N as Fe,p as Ue,o as Te,q as Be,b7 as ze,b8 as Ae,b9 as Le,aW as Ge,ba as He,aX as Re,bb as Oe,r,aM as g,aP as Me,aQ as $e,bc as qe,bd as Je,be as Qe,w as me,j as e,F as U,bf as We,bg as Xe,G as d,H as n,bh as Ke,bi as Ve,bj as Ye,bk as Ze,bl as ea,x as aa}from"./index-B9-9R2Yl.js";import{S as T}from"./Spinner-ChA3OBv3.js";const ra=()=>{const{enqueueSnackbar:m}=we(),l=De(),f=o(ke),pe=o(Ee),j=o(Fe),B=o(Ue),s=o(Te)||{},v=o(Be),z=o(ze),A=o(Ae),L=o(Le),h=o(Ge),he=o(He),p=o(Re),G=o(Oe),[ge,b]=r.useState(!1),[xe,H]=r.useState(!1),[R,O]=r.useState(""),[M,$]=r.useState(""),[q,J]=r.useState(""),[Q,W]=r.useState(""),[X,K]=r.useState(""),[V,Y]=r.useState(""),[Z,ee]=r.useState(0),[y,S]=r.useState([]),[N,C]=r.useState([]),[ae,I]=r.useState(""),[te,_]=r.useState(""),[se,re]=r.useState(""),[le,P]=r.useState(""),[ne,w]=r.useState(""),[ie,D]=r.useState(""),[oe,k]=r.useState(0),[ce,de]=r.useState([]),[E,x]=r.useState([]),[F,fe]=r.useState([]);r.useEffect(()=>{l(g()),l(Me()),l($e())},[l]),console.log(h);const je=a=>{C(N.filter((t,i)=>i!==a)),S(y.filter((t,i)=>i!==a))},ue=()=>{I(""),_(""),re(""),P(""),w(""),D(""),k(0),de([]),x([]),H(!1)},ve=a=>{a.preventDefault();let t=new FormData;t.append("name",R),t.append("price",M),t.append("description",q),t.append("categoryId",Q),t.append("brandId",X),t.append("type",V),t.append("stock",Z),y.length>0&&y.forEach(i=>{t.append("images",i)}),l(Ke(t))},be=a=>{a.preventDefault();let t=new FormData;t.append("name",ae),t.append("price",te),t.append("description",se),t.append("categoryId",le),t.append("brandId",ne),t.append("type",ie),t.append("stock",oe),F.length>0&&t.append("imagesToDelete",JSON.stringify(F)),ce.length>0&&ce.forEach(i=>{t.append("images",i)}),l(Ve({id:s==null?void 0:s._id,formData:t}))};r.useEffect(()=>{if(z){m("Product Created Successfully!",{variant:"success",anchorOrigin:{vertical:"top",horizontal:"center"}}),b(!1),ye(),l(qe()),l(g());return}if(L){m("Product Deleted Successfully!",{variant:"success",anchorOrigin:{vertical:"top",horizontal:"center"}}),l(Je()),l(g());return}if(A){m("Product Updated Successfully!",{variant:"success",anchorOrigin:{vertical:"top",horizontal:"center"}}),ue(),l(Qe()),l(g());return}if(v){m(v,{variant:"error",anchorOrigin:{vertical:"top",horizontal:"center"}}),l(me());return}if(j){m(j,{variant:"error",anchorOrigin:{vertical:"top",horizontal:"center"}}),l(me());return}},[z,L,A,v,j,l,m]);const ye=()=>{O(""),$(""),J(""),W(""),K(""),Y(""),ee(0),S([]),C([])},Se=a=>{window.confirm("Are you sure you want to delete this product?")&&(l(ea(a)),l(g()))},Ne=a=>{H(!0),l(aa(a))},Ce=()=>{const a={columns:[{label:"Name",field:"name",sort:"asc"},{label:"Price",field:"price",sort:"asc"},{label:"Stock",field:"stock",sort:"asc"},{label:"Category",field:"category",sort:"asc"},{label:"Brand",field:"brand",sort:"asc"},{label:"Type",field:"type",sort:"asc"},{label:"Action",field:"actions",sort:"asc"}],rows:[]};return f&&f.length>0&&f.forEach(t=>{a.rows.push({name:e.jsxs(e.Fragment,{children:[t.name,e.jsx("br",{}),e.jsxs("span",{className:"text-secondary",style:{fontSize:"14px"},children:["(",t._id,")"]})]}),price:`₹${t.price}`,stock:t.stock,category:t.category,brand:t.brand,type:t.type,actions:e.jsxs(e.Fragment,{children:[e.jsx(U,{variant:"info",size:"sm",className:"mr-2",onClick:()=>Ne(t._id),children:e.jsx(Ye,{})}),e.jsx(U,{variant:"danger",size:"sm",onClick:()=>Se(t._id),children:e.jsx(Ze,{})})]})})}),a},Ie=a=>{a.preventDefault();const t=Array.from(a.target.files);t.length>0&&t.forEach(i=>{const c=new FileReader;c.onload=()=>{c.readyState==2&&(C(u=>[...u,c.result]),S(u=>[...u,i]))},c.readAsDataURL(i)})},_e=a=>{const t=Array.from(a.target.files);t.length>0&&t.forEach(i=>{de(u=>[...u,i]);const c=new FileReader;c.onload=()=>{c.readyState===2&&x(u=>[...u,c.result])},c.readAsDataURL(i)})};r.useEffect(()=>{var a;if(s){I((s==null?void 0:s.name)??""),_((s==null?void 0:s.price)??""),re((s==null?void 0:s.description)??""),P((s==null?void 0:s.categoryId)??""),w((s==null?void 0:s.brandId)??""),D((s==null?void 0:s.type)??""),k((s==null?void 0:s.stock)??"");let t=[];((a=s==null?void 0:s.images)==null?void 0:a.length)>0&&(s==null||s.images.forEach(i=>{t.push(i.image)})),x(t)}},[s]);const Pe=a=>{fe([...F,a]),x(E.filter(t=>t!==a))};return e.jsxs("div",{children:[e.jsx("h2",{children:"Products"}),e.jsx(e.Fragment,{children:pe==="loading"?e.jsxs("div",{className:"d-flex align-items-start justify-content-center",children:[e.jsx("div",{className:"loader"})," "]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:" px-3 my-2 d-flex align-items-start justify-content-start",children:e.jsxs(U,{variant:"primary",onClick:()=>b(!0),children:["ADD   ",e.jsx(We,{fontSize:"1.5rem"})]})}),e.jsx(Xe,{className:"px-3",bordered:!0,striped:!0,hover:!0,responsive:!0,data:Ce()})]})}),e.jsxs(d,{show:ge,onHide:()=>b(!1),size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[e.jsx(d.Header,{closeButton:!0,children:e.jsx(d.Title,{id:"contained-modal-title-vcenter",children:"Create New Product"})}),e.jsx(d.Body,{children:e.jsx("div",{className:"px-2",children:e.jsx("div",{children:e.jsxs("form",{encType:"multipart/form-data",onSubmit:ve,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Images"}),e.jsxs("div",{className:"custom-file",children:[e.jsx("input",{type:"file",name:"product_images",className:"custom-file-input",id:"customFile",height:"50",width:"100",multiple:!0,onChange:Ie}),e.jsx("label",{className:"custom-file-label",for:"customFile",children:"Choose Images"})]}),e.jsxs("div",{className:"d-flex ",children:[N.length>0&&N.map((a,t)=>e.jsxs("div",{className:"mt-3 mr-5 position-relative",children:[e.jsx("img",{src:a,className:"border",alt:`image  Preview${t}`,height:"65",width:"65"},t),e.jsx("button",{variant:"danger",className:"border btn btn-secondary rounded-circle position-absolute top-0 right-0 py-0 px-2",size:"md",onClick:()=>je(t),children:"×"})]},t))," "]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"name_field",children:"Name"}),e.jsx("input",{type:"text",id:"name_field",className:"form-control",value:R,onChange:a=>O(a.target.value)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{for:"price_field",children:"Price"}),e.jsx("input",{type:"text",id:"price_field",className:"form-control",value:M,onChange:a=>$(a.target.value)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{for:"description_field",children:"Description"}),e.jsx("textarea",{value:q,onChange:a=>J(a.target.value),className:"form-control",id:"description_field",rows:"8"})]}),e.jsxs(n.Group,{controlId:"category_field",className:"mb-3",children:[e.jsx(n.Label,{children:"Category"}),e.jsxs(n.Control,{as:"select",value:Q,onChange:a=>W(a.target.value),children:[e.jsx("option",{disabled:!0,value:"",children:"Select "}),h.length>0?h.map(a=>e.jsx("option",{value:a._id,children:a.title},a._id)):e.jsx("option",{disabled:!0,children:"No categories found"})]})]}),e.jsxs(n.Group,{controlId:"category_field",className:"mb-3",children:[e.jsx(n.Label,{children:"Brand"}),e.jsxs(n.Control,{as:"select",value:X,onChange:a=>K(a.target.value),children:[e.jsx("option",{disabled:!0,value:"",children:"Select "}),G==="loading"?e.jsx(T,{animation:"border",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})}):p.length>0&&(p==null?void 0:p.map(a=>e.jsx("option",{value:a._id,children:a.title},a._id)))]})]}),e.jsxs(n.Group,{controlId:"category_field",className:"mb-3",children:[e.jsx(n.Label,{children:"Type"}),e.jsxs(n.Control,{as:"select",value:V,onChange:a=>Y(a.target.value),children:[e.jsx("option",{value:"",children:"Select "}),e.jsx("option",{value:"sales",children:"Sales "}),e.jsx("option",{value:"service",children:"Service "})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{for:"stock_field",children:"Stock"}),e.jsx("input",{type:"number",id:"stock_field",className:"form-control",value:Z,onChange:a=>ee(a.target.value)})]}),e.jsx("button",{id:"login_button",type:"submit",className:"btn btn-block py-3 border",disabled:B==="loading",children:"CREATE"})]})})})})]}),e.jsxs(d,{show:xe,onHide:ue,size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[e.jsx(d.Header,{closeButton:!0,children:e.jsx(d.Title,{id:"contained-modal-title-vcenter",children:"Update Product"})}),e.jsx(d.Body,{children:e.jsx("div",{className:"px-2",children:e.jsx("div",{children:e.jsxs("form",{encType:"multipart/form-data",onSubmit:be,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Images"}),e.jsxs("div",{className:"custom-file",children:[e.jsx("input",{type:"file",name:"product_images",className:"custom-file-input",id:"customFile",height:"50",width:"100",multiple:!0,onChange:_e}),e.jsx("label",{className:"custom-file-label",for:"customFile",children:"Choose Images"})]}),e.jsx("div",{className:"d-flex align-items-center",children:E.length>0&&E.map((a,t)=>e.jsxs("div",{className:"mt-3 mr-5 position-relative",children:[e.jsx("img",{src:a,className:"border",alt:`image  Preview${t}`,height:"65",width:"65"},t),e.jsx("button",{type:"button",variant:"danger",className:"border btn btn-secondary rounded-circle position-absolute top-0 right-0 py-0 px-2",size:"md",onClick:()=>Pe(a),children:"×"})]},t))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{for:"name_field",children:"Name"}),e.jsx("input",{type:"text",id:"name_field",className:"form-control",value:ae,onChange:a=>I(a.target.value)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{for:"price_field",children:"Price"}),e.jsx("input",{type:"text",id:"price_field",className:"form-control",value:te,onChange:a=>_(a.target.value)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{for:"description_field",children:"Description"}),e.jsx("textarea",{value:se,onChange:a=>setUpdateDesciption(a.target.value),className:"form-control",id:"description_field",rows:"8"})]}),e.jsxs(n.Group,{controlId:"category_field",className:"mb-3",children:[e.jsx(n.Label,{children:"Category"}),e.jsxs(n.Control,{as:"select",value:le,onChange:a=>P(a.target.value),children:[e.jsx("option",{disabled:!0,value:"",children:"Select "}),he==="loading"?e.jsx(T,{animation:"border",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})}):e.jsxs(e.Fragment,{children:["  ",h.length>0&&h.map(a=>e.jsx("option",{value:a._id,children:a.title},a._id))]})]})]}),e.jsxs(n.Group,{controlId:"category_field",className:"mb-3",children:[e.jsx(n.Label,{children:"Brand"}),e.jsxs(n.Control,{as:"select",value:ne,onChange:a=>w(a.target.value),children:[e.jsx("option",{disabled:!0,value:"",children:"Select "}),G==="loading"?e.jsx(T,{animation:"border",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})}):p.length>0&&p.map(a=>e.jsx("option",{value:a._id,children:a.title},a._id))]})]}),e.jsxs(n.Group,{controlId:"category_field",className:"mb-3",children:[e.jsx(n.Label,{children:"Product Type"}),e.jsxs(n.Control,{as:"select",value:ie,onChange:a=>D(a.target.value),children:[e.jsx("option",{value:"",children:"Select "}),e.jsx("option",{value:"sales",children:"Sales "}),e.jsx("option",{value:"service",children:"Service "})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{for:"stock_field",children:"Stock"}),e.jsx("input",{type:"number",id:"stock_field",className:"form-control",value:oe,onChange:a=>k(a.target.value)})]}),e.jsx("button",{id:"login_button",type:"submit",className:"btn btn-block py-3 border",disabled:B==="loading",children:"UPDATE"})]})})})})]})]})};export{ra as AdminProduct,ra as default};
